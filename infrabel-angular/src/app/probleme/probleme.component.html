<h1>Problèmes en gare</h1>

<div class="container">
    <div class="gare">

      <p></p>

      <mat-form-field>
        <input type="text" placeholder="Gare" aria-label="Recherche" matInput [formControl]="departControl" [matAutocomplete]="auto1">
        <mat-autocomplete #auto1="matAutocomplete">
          <mat-option *ngFor="let option of filterredOption |async" [value]="option">
            {{ option | titlecase }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>

      <button mat-raised-button  color="primary" (click)="getData()">Lancer la recherche</button>

      <div id="results" *ngIf="showResult">
        <div id="onStation">
          <p>
            À {{ departControl.value | titlecase }}, les trains ont en moyenne
            <span *ngIf="averageDelayArrivalInTime.hours > 0">{{averageDelayArrivalInTime.hours}} heures </span>
            {{averageDelayArrivalInTime.minutes}} minutes
            et {{averageDelayArrivalInTime.seconds}} secondes de retard à l'arrivée et
            <span *ngIf="averageDelayDepartureInTime.hours > 0">{{averageDelayDepartureInTime.hours}} heures </span>
            {{averageDelayDepartureInTime.minutes}} minutes et
            {{averageDelayDepartureInTime.seconds}} secondes de retard au départ.
          </p>
          <p>
            Sur le dernier mois, il y a eu {{nbIncident}} incidents, engendrant {{nbRetardTotal}} minutes de retard cumulées et {{nbTrainsSuppTotal}} trains supprimés cumulés.
            => graph lignes sur l'évolution des nb d'incidents, nb de trains supprimés et retards sur le mois
          </p>
          <div>
            <!-- <ngx-charts-line-chart
              [results]="incidentGraph"
              [legend]="true"
              [xAxis]="true"
              [yAxis]="true"
            >
            </ngx-charts-line-chart> -->
          </div>

          <p>Le plus gros retard ce mois-ci était de {{plusGrosRetard}} minutes à cause de {{plusGrosIncident | lowercase}} et a provoqué la suppression de {{plusGrosTrainsSupp}} trains.</p>
          <p>L'incident le plus récent était {{latestIncident | lowercase}}, ce qui a engendré {{latestDelay}} minutes de retard et {{latestTrainsSupp}} trains supprimés.</p>

          <ul>
            <li>Voir les mêmes stats pour un mois sélectionné.</li>
          </ul>

        </div>
        <div id="onRelation">
          <p>
            Les relations dans lesquelles se trouve {{ departControl.value | titlecase }} ont en moyenne {{relationArrivalAverage}} minutes de retard à l'arrivée et {{relationDepartureAverage}} minutes de retard au départ.
          </p>
          <p>
            Les relations dans lesquelles se trouve {{ departControl.value | titlecase }} ont en moyenne x incidents, le plus récurrent étant x.
          </p>
        </div>
      </div>
    </div>
  </div>

